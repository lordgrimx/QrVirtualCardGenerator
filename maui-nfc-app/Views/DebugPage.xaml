<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="MauiNfcApp.Views.DebugPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MauiNfcApp.ViewModels"
             x:DataType="vm:DebugViewModel"
             Title="Debug Panel"
             BackgroundColor="{AppThemeBinding Light=#F5F5F5, Dark=#1E1E1E}">

    <ScrollView>
        <StackLayout Padding="20" Spacing="15">
            
            <!-- Debug Mode Indicator -->
            <Frame BackgroundColor="Orange" Padding="10" HasShadow="False" CornerRadius="8">
                <Label Text="🔧 DEBUG MODE ACTIVE" 
                       FontAttributes="Bold" 
                       HorizontalTextAlignment="Center"
                       TextColor="White" />
            </Frame>

            <!-- Test Configuration -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}" 
                   HasShadow="True" CornerRadius="12" Padding="20">
                <StackLayout>
                    <Label Text="⚙️ Test Konfigürasyonu" 
                           FontSize="18" FontAttributes="Bold" Margin="0,0,0,15" />
                    
                    <Grid ColumnDefinitions="*,Auto" RowDefinitions="Auto,Auto,Auto" RowSpacing="10">
                        <Label Grid.Row="0" Grid.Column="0" Text="Mock Mode:" VerticalOptions="Center" />
                        <Switch Grid.Row="0" Grid.Column="1" IsToggled="{Binding IsMockMode}" />
                        
                        <Label Grid.Row="1" Grid.Column="0" Text="Backend URL:" VerticalOptions="Center" />
                        <Button Grid.Row="1" Grid.Column="1" Text="Düzenle" 
                                Command="{Binding EditBackendUrlCommand}" FontSize="12" />
                        
                        <Label Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" 
                               Text="{Binding BackendUrl}" FontSize="12" TextColor="Gray" />
                    </Grid>
                </StackLayout>
            </Frame>

            <!-- System Info -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}" 
                   HasShadow="True" CornerRadius="12" Padding="20">
                <StackLayout>
                    <Label Text="📱 Sistem Bilgileri" 
                           FontSize="18" FontAttributes="Bold" Margin="0,0,0,15" />
                    
                    <CollectionView ItemsSource="{Binding SystemInfo}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="vm:SystemInfoItem">
                                <Grid ColumnDefinitions="Auto,*" ColumnSpacing="10" Margin="0,2">
                                    <Label Grid.Column="0" Text="{Binding Key}" FontAttributes="Bold" />
                                    <Label Grid.Column="1" Text="{Binding Value}" />
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
            </Frame>

            <!-- NFC Diagnostics -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}" 
                   HasShadow="True" CornerRadius="12" Padding="20">
                <StackLayout>
                    <Label Text="📡 NFC Diagnostik" 
                           FontSize="18" FontAttributes="Bold" Margin="0,0,0,15" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" Text="🧪 Mock Data Gönder" 
                                Command="{Binding SendMockDataCommand}"
                                BackgroundColor="Green" TextColor="White" />
                        <Button Grid.Column="1" Text="🔧 NFC Test" 
                                Command="{Binding TestNfcCommand}"
                                BackgroundColor="Blue" TextColor="White" />
                    </Grid>
                    
                    <Label Text="{Binding NfcTestResult}" 
                           Margin="0,10,0,0" FontSize="12" />
                </StackLayout>
            </Frame>

            <!-- Crypto Test -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}" 
                   HasShadow="True" CornerRadius="12" Padding="20">
                <StackLayout>
                    <Label Text="🔐 Kripto Testi" 
                           FontSize="18" FontAttributes="Bold" Margin="0,0,0,15" />
                    
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                        <Button Grid.Column="0" Text="🧪 Test Public Key" 
                                Command="{Binding TestPublicKeyCommand}"
                                BackgroundColor="Purple" TextColor="White" />
                        <Button Grid.Column="1" Text="✅ Test Verification" 
                                Command="{Binding TestVerificationCommand}"
                                BackgroundColor="Orange" TextColor="White" />
                    </Grid>
                    
                    <Label Text="{Binding CryptoTestResult}" 
                           Margin="0,10,0,0" FontSize="12" />
                </StackLayout>
            </Frame>

            <!-- Log Viewer -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}" 
                   HasShadow="True" CornerRadius="12" Padding="20">
                <StackLayout>
                    <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,15">
                        <Label Grid.Column="0" Text="📝 Debug Logları" 
                               FontSize="18" FontAttributes="Bold" />
                        <Button Grid.Column="1" Text="🗑️ Temizle" 
                                Command="{Binding ClearLogsCommand}" FontSize="12" />
                    </Grid>
                    
                    <CollectionView ItemsSource="{Binding DebugLogs}" MaximumHeightRequest="200">
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="vm:DebugLogEntry">
                                <StackLayout Margin="0,2" Padding="5" 
                                             BackgroundColor="{AppThemeBinding Light=#F8F8F8, Dark=#333333}">
                                    <Grid ColumnDefinitions="Auto,*" ColumnSpacing="8">
                                        <Label Grid.Column="0" Text="{Binding Timestamp, StringFormat='{0:HH:mm:ss}'}" 
                                               FontSize="10" TextColor="Gray" />
                                        <Label Grid.Column="1" Text="{Binding Message}" FontSize="11" />
                                    </Grid>
                                </StackLayout>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </StackLayout>
            </Frame>

            <!-- Actions -->
            <Frame BackgroundColor="{AppThemeBinding Light=White, Dark=#2D2D2D}" 
                   HasShadow="True" CornerRadius="12" Padding="20">
                <StackLayout>
                    <Label Text="🎯 Test Aksiyonları" 
                           FontSize="18" FontAttributes="Bold" Margin="0,0,0,15" />
                    
                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" 
                          ColumnSpacing="10" RowSpacing="10">
                        <Button Grid.Row="0" Grid.Column="0" Text="💾 Ayarları Kaydet" 
                                Command="{Binding SaveSettingsCommand}"
                                BackgroundColor="Gray" TextColor="White" />
                        <Button Grid.Row="0" Grid.Column="1" Text="🔄 Ayarları Sıfırla" 
                                Command="{Binding ResetSettingsCommand}"
                                BackgroundColor="Red" TextColor="White" />
                        <Button Grid.Row="1" Grid.Column="0" Text="📊 Diagnostik Rapor" 
                                Command="{Binding GenerateReportCommand}"
                                BackgroundColor="Teal" TextColor="White" />
                        <Button Grid.Row="1" Grid.Column="1" Text="🏠 Ana Sayfaya Dön" 
                                Command="{Binding GoToMainPageCommand}"
                                BackgroundColor="Green" TextColor="White" />
                    </Grid>
                </StackLayout>
            </Frame>

        </StackLayout>
    </ScrollView>

</ContentPage>
