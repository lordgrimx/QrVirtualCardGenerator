<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MauiNfcReader.Views.NfcReaderPage"
             Title="NFC Kart Okuyucu"
             BackgroundColor="#FEF2F2">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Background Gradient -->
        <Rectangle Grid.RowSpan="3">
            <Rectangle.Fill>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#FEF2F2" Offset="0.0" />
                    <GradientStop Color="#FFF7ED" Offset="1.0" />
                </LinearGradientBrush>
            </Rectangle.Fill>
        </Rectangle>

        <!-- Header -->
        <Frame Grid.Row="0" 
               BackgroundColor="White" 
               Padding="20,16" 
               HasShadow="True" 
               CornerRadius="0,0,24,24"
               Opacity="0.95"
               Margin="0,0,0,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Back Button -->
                <Button Grid.Column="0"
                        Text="←"
                        FontSize="24"
                        BackgroundColor="Transparent"
                        TextColor="#DC2626"
                        Padding="8"
                        VerticalOptions="Center"
                        Clicked="OnBackClicked"/>
                
                <!-- Title -->
                <Label Grid.Column="1"
                       Text="NFC Kart Okuyucu" 
                       FontSize="20" 
                       FontAttributes="Bold" 
                       TextColor="#111827"
                       VerticalOptions="Center"
                       HorizontalOptions="Center" />
                
                <!-- Status Indicator -->
                <Grid Grid.Column="2" VerticalOptions="Center">
                    <Ellipse x:Name="StatusIndicator"
                             Fill="#10B981"
                             WidthRequest="12"
                             HeightRequest="12"/>
                </Grid>
            </Grid>
        </Frame>

        <!-- Main Content -->
        <ScrollView Grid.Row="1" Padding="16,0">
            <VerticalStackLayout Spacing="20">
                
                <!-- NFC Status Card -->
                <Frame BackgroundColor="White" 
                       Padding="24" 
                       HasShadow="True" 
                       CornerRadius="20"
                       Opacity="0.95">
                    <VerticalStackLayout Spacing="20">
                        
                        <!-- NFC Animation Area -->
                        <Frame BackgroundColor="#FEF2F2"
                               WidthRequest="120"
                               HeightRequest="120"
                               CornerRadius="60"
                               Padding="0"
                               HorizontalOptions="Center"
                               HasShadow="False">
                            <Grid>
                                <!-- NFC Icon with Animation -->
                                <Label Text="📡"
                                       FontSize="48"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"
                                       x:Name="NfcIcon"/>
                                
                                <!-- Pulse Animation Circle -->
                                <Ellipse x:Name="PulseCircle"
                                         Stroke="#DC2626"
                                         StrokeThickness="2"
                                         Fill="Transparent"
                                         WidthRequest="80"
                                         HeightRequest="80"
                                         HorizontalOptions="Center"
                                         VerticalOptions="Center"
                                         Opacity="0.6"/>
                            </Grid>
                        </Frame>
                        
                        <!-- Status Text -->
                        <VerticalStackLayout Spacing="8">
                            <Label x:Name="NfcStatusLabel"
                                   Text="NFC Okuyucu Hazır"
                                   FontSize="18"
                                   FontAttributes="Bold"
                                   TextColor="#111827"
                                   HorizontalOptions="Center" />
                            <Label x:Name="NfcSubStatusLabel"
                                   Text="Kartınızı okuyucuya yaklaştırın"
                                   FontSize="14"
                                   TextColor="#6B7280"
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                        
                        <!-- Action Buttons -->
                        <VerticalStackLayout Spacing="12">
                            <Button x:Name="StartReadingBtn"
                                    Text="📡 Okumaya Başla"
                                    FontSize="16"
                                    FontAttributes="Bold"
                                    HeightRequest="52"
                                    CornerRadius="16"
                                    Clicked="OnStartReadingClicked"
                                    HorizontalOptions="Fill">
                                <Button.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                        <GradientStop Color="#DC2626" Offset="0.0" />
                                        <GradientStop Color="#EA580C" Offset="1.0" />
                                    </LinearGradientBrush>
                                </Button.Background>
                                <Button.TextColor>White</Button.TextColor>
                            </Button>
                            
                            <Button x:Name="StopReadingBtn"
                                    Text="⏹️ Okumayı Durdur"
                                    FontSize="16"
                                    FontAttributes="Bold"
                                    BackgroundColor="White"
                                    TextColor="#EF4444"
                                    HeightRequest="52"
                                    CornerRadius="16"
                                    BorderColor="#FEE2E2"
                                    BorderWidth="1"
                                    Clicked="OnStopReadingClicked"
                                    HorizontalOptions="Fill"
                                    IsVisible="False" />
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>

                <!-- Last Read Card Info (Initially Hidden) -->
                <Frame x:Name="LastReadCard" 
                       BackgroundColor="White" 
                       Padding="20" 
                       HasShadow="True" 
                       CornerRadius="16"
                       Opacity="0.95"
                       IsVisible="False">
                    <VerticalStackLayout Spacing="16">
                        <Label Text="Son Okunan Kart" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               TextColor="#111827" />
                        
                        <!-- Card Info Grid -->
                        <Grid RowSpacing="12" ColumnSpacing="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- UID -->
                            <Label Grid.Row="0" Grid.Column="0" 
                                   Text="UID:" 
                                   FontAttributes="Bold"
                                   TextColor="#374151" />
                            <Label Grid.Row="0" Grid.Column="1" 
                                   x:Name="UidLabel"
                                   Text="-" 
                                   TextColor="#111827"
                                   FontFamily="Courier" />
                            
                            <!-- Card Type -->
                            <Label Grid.Row="1" Grid.Column="0" 
                                   Text="Kart Türü:" 
                                   FontAttributes="Bold"
                                   TextColor="#374151" />
                            <Label Grid.Row="1" Grid.Column="1" 
                                   x:Name="CardTypeLabel"
                                   Text="-" 
                                   TextColor="#111827" />
                            
                            <!-- Member ID -->
                            <Label Grid.Row="2" Grid.Column="0" 
                                   Text="Üye ID:" 
                                   FontAttributes="Bold"
                                   TextColor="#374151" />
                            <Label Grid.Row="2" Grid.Column="1" 
                                   x:Name="MemberIdLabel"
                                   Text="-" 
                                   TextColor="#111827" />
                            
                            <!-- Read Time -->
                            <Label Grid.Row="3" Grid.Column="0" 
                                   Text="Okuma Zamanı:" 
                                   FontAttributes="Bold"
                                   TextColor="#374151" />
                            <Label Grid.Row="3" Grid.Column="1" 
                                   x:Name="ReadTimeLabel"
                                   Text="-" 
                                   TextColor="#6B7280"
                                   FontSize="12" />
                        </Grid>
                        
                        <!-- Verify Button -->
                        <Button x:Name="VerifyMemberBtn"
                                Text="🔍 Üye Bilgilerini Görüntüle"
                                FontSize="14"
                                FontAttributes="Bold"
                                BackgroundColor="#F3F4F6"
                                TextColor="#374151"
                                HeightRequest="44"
                                CornerRadius="12"
                                Clicked="OnVerifyMemberClicked"
                                HorizontalOptions="Fill" />
                    </VerticalStackLayout>
                </Frame>

                <!-- Settings Card -->
                <Frame BackgroundColor="White" 
                       Padding="20" 
                       HasShadow="True" 
                       CornerRadius="16"
                       Opacity="0.95">
                    <VerticalStackLayout Spacing="16">
                        <Label Text="Ayarlar" 
                               FontSize="18" 
                               FontAttributes="Bold" 
                               TextColor="#111827" />
                        
                        <!-- Settings Options -->
                        <VerticalStackLayout Spacing="8">
                            
                            <!-- Auto Read Toggle -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <VerticalStackLayout Grid.Column="0">
                                    <Label Text="Otomatik Okuma" 
                                           FontSize="14" 
                                           FontAttributes="Bold"
                                           TextColor="#111827" />
                                    <Label Text="Kart algılandığında otomatik oku" 
                                           FontSize="12" 
                                           TextColor="#6B7280" />
                                </VerticalStackLayout>
                                
                                <Switch Grid.Column="1" 
                                        x:Name="AutoReadSwitch"
                                        IsToggled="True"
                                        OnColor="#DC2626"
                                        ThumbColor="White"
                                        Toggled="OnAutoReadToggled"/>
                            </Grid>
                            
                            <!-- Sound Toggle -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <VerticalStackLayout Grid.Column="0">
                                    <Label Text="Ses Efektleri" 
                                           FontSize="14" 
                                           FontAttributes="Bold"
                                           TextColor="#111827" />
                                    <Label Text="Başarılı okumada ses çal" 
                                           FontSize="12" 
                                           TextColor="#6B7280" />
                                </VerticalStackLayout>
                                
                                <Switch Grid.Column="1" 
                                        x:Name="SoundSwitch"
                                        IsToggled="True"
                                        OnColor="#DC2626"
                                        ThumbColor="White"
                                        Toggled="OnSoundToggled"/>
                            </Grid>
                            
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Bottom Action Bar -->
        <Frame Grid.Row="2" 
               BackgroundColor="White" 
               HasShadow="True" 
               Padding="16" 
               CornerRadius="24,24,0,0"
               Opacity="0.95">
            <HorizontalStackLayout Spacing="12" HorizontalOptions="Center">
                <Button Text="🏠 Ana Sayfa"
                        FontSize="14"
                        BackgroundColor="Transparent"
                        TextColor="#6B7280"
                        Clicked="OnHomeClicked" />
                
                <Button Text="👥 Üye Ara"
                        FontSize="14"
                        BackgroundColor="Transparent"
                        TextColor="#6B7280"
                        Clicked="OnSearchMemberClicked" />
                
                <Button Text="⚙️ Ayarlar"
                        FontSize="14"
                        BackgroundColor="Transparent"
                        TextColor="#6B7280"
                        Clicked="OnSettingsClicked" />
            </HorizontalStackLayout>
        </Frame>

    </Grid>

</ContentPage>